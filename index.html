<!DOCTYPE html>
<html>
<head>
    <title>AI Personas Demo v1</title>
</head>
<body>
    <input type="text" id="apiKeyInput" placeholder="Enter your API key">
    <br>
    <input type="text" id="textInput" placeholder="Enter text here">
    <button onclick="generateResponses()">Speak</button>
    <div id="angryOutput"></div>
    <div id="professorOutput"></div>
    <div id="grade2Output"></div>

    <script>
        async function generateResponses() {
            try {
                const apiKey = document.getElementById("apiKeyInput").value;
                const inputText = document.getElementById("textInput").value;

                if (!apiKey || !inputText) {
                    alert("Please enter both API key and text to proceed.");
                    return;
                }
                
                const angryResponse = await getChatGPTResponse(apiKey, inputText, "angry persona");
                const professorResponse = await getChatGPTResponse(apiKey, inputText, "professor persona");
                const grade2Response = await getChatGPTResponse(apiKey, inputText, "grade2 in a bad mood persona");

                document.getElementById("angryOutput").innerText = "Angry Persona: " + angryResponse.choices[0].text.trim();
                document.getElementById("professorOutput").innerText = "Snooty College Professor: " + professorResponse.choices[0].text.trim();
                document.getElementById("grade2Output").innerText = "Grade 2 in a Bad Mood: " + grade2Response.choices[0].text.trim();
            } catch (error) {
                alert("An error occurred. Please check the console for more details.");
                console.error(error);
            }
        }

        async function getChatGPTResponse(apiKey, input, persona) {
    const response = await fetch('https://api.openai.com/v1/engines/davinci/completions', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${apiKey}`
        },
        body: JSON.stringify({
            prompt: {
                'role': 'system',
                'content': `This is a ${persona} persona: ${input}`
            },
            max_tokens: 50
        })
    });

    if (!response.ok) {
        throw new Error(`HTTP error! Status: ${response.status}`);
    }

    return response.json();
}

    </script>
</body>
</html>
